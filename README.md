# 大二暑假开发的oj系统
jlnuOj-mojbr>
mar1<br>
# 2024-07-1 开始
# moj

## 项目介绍

基于 vue + Spring Boot。

### 实现的核心思路
1）权限校验 

谁能提代码，谁不能提代码

2）代码沙箱（安全沙箱）

用户代码藏毒：写个木马文件、修改系统权限

沙箱：隔离的、安全的环境，用户的代码不会影响到沙箱之外的系统的运行资源分配

3）判题规则

题目用例的比对，结果的验证

4）任务调度

服务器资源有限，用户要排队，按照顺序去依次执行判题，而不是直接拒绝



###流程图
![img.png](img.png)
![img_1.png](img_1.png)


暂定的核心技术如下，可能会引入新技术


### 前端

- vue + 组件库:arco-design + 代码编辑器
- 前端工程化：ESLint + Prettier + TypeScript


### 后端

- Java Spring Boot + MySQL + MyBatis Plus
- Java进程控制器
- Spring Cloud 微服务 :nacos 消息队列
- Redis 
- 对象存储
- ## 架构设计
![img_2.png](img_2.png)









如果想要使用这套模板生成其他的代码，只需要改变参数的值即可，而不需要改变模板文件。

理解了代码生成器的核心原理后，就可以开始思考项目的设计实现方案了。



------



项目总共分为 3 个阶段，让我们分别来进行设计。



### 第一阶段 - 本地代码生成器

这个阶段，我们的目标是做一个本地（离线）的代码生成器，实现一个简易的 Java ACM 模板项目的定制化生成。

本阶段不依赖复杂的开发框架，**没学过任何开发框架也能学习。**



#### 业务流程

1）准备用于制作代码生成器的原始代码（比如 Java ACM 模板项目），用于后续生成

2）开发者基于原始代码，设置参数、编写动态模板

3）制作可交互的命令行工具，支持用户输入参数，得到代码生成器 jar 包

4）使用者得到代码生成器 jar 包，执行程序并输入参数，从而生成完整代码



流程图如下：

![](https://pic.yupi.icu/1/1698930303648-d82309e8-bbde-43dd-adb2-9d0c647e1e40-20231103004425416.jpeg)



#### 实现思路

1）先根据本地项目，扫描文件树，实现同样的静态代码生成

2）根据本地的项目，预设部分动态参数、编写模板文件，能够传入配置对象进行生成

3）制作可交互的命令行工具，接受用户输入的参数，并动态生成代码

4）封装制作代码生成器 jar 包文件，并简化使用命令



#### 关键问题

如何根据一套项目文件，完整地生成同样一套项目？

如何编写动态模板文件？怎么根据模板和参数生成代码？

如何制作命令行工具？如何交互式接受用户的输入？

怎么将命令行工具制作为 jar 包？怎么简化使用命令？



### 第二阶段 - 代码生成器制作工具

这个阶段，我们的目标是做一个本地的代码生成器制作工具，能够快速将一个项目制作为可以动态定制部分内容的代码生成器。并且以一个 Spring Boot 初始化项目模板（Maven 项目）为例，演示如何根据自己的需要动态生成 Java 后端初始化项目。




#### 业务流程

1）准备用于制作代码生成器的原始代码（比如 Spring Boot 项目模板），用于后续生成

2）开发者基于原始代码，**使用代码生成器制作工具**，来快速设置参数、生成动态模板

3）**使用代码生成器制作工具**，动态生成代码生成器 jar 包

4）使用者得到代码生成器 jar 包，执行程序并输入参数，从而生成完整代码



相比第一阶段的业务流程，本阶段完成后，可以直接使用代码生成器制作工具来快速将固定的项目代码改造为可定制生成的动态模板，并自动生成命令行工具 jar 包。



流程图如下：

![](https://pic.yupi.icu/1/1698843403252-3ee97aaa-c20e-4922-ae0e-1195b44e1c3b-20231103004430323.jpeg)



#### 实现思路

1）使用独立空间来存储管理要生成的原始文件、动态模板文件等

2）使用配置文件来记录要生成的参数和模板文件信息、自定义配置等 **元信息**

3）代码生成器制作工具需要有多种可单独或组合使用的功能，比如从原始文件中抽取参数、动态生成命令行工具、打 jar 包等



#### 关键问题

1）如何使用配置文件来记录参数和模板文件信息？何种结构？

2）怎么能够提高代码生成器的制作效率？工具应该提供哪些能力？

3）如何从原始文件中抽取参数？有哪些类型的参数？有哪些抽取规则？比如布尔类型参数（是否生成）、字符串类型参数（生成指定的值）等

![](https://pic.yupi.icu/1/1698930808644-1dc4e66a-0ea5-4128-aed3-73b828330666.png)

4）如何动态生成配置类？如何动态生成命令行工具？如何动态打 jar 包？



### 第三阶段 - 在线代码生成器平台

经过前两个阶段，我们已经能够使用本地的代码生成器制作工具来快速定制自己的代码生成器了。

但如果我们想和团队其他同学共同维护代码生成器、或者使用其他人的代码生成器，通过本地文件互传的方式肯定就很麻烦了。

所以本阶段要打造一个在线代码生成器平台，可以理解为代码生成器的 **应用市场**。所有人都能发布、使用、甚至是在线制作自己的代码生成器！



#### 业务流程

1）获取用于制作代码生成器的原始代码（手动准备或者远程拉取代码）

2）开发者基于原始代码，使用 **在线代码生成器制作工具**，来快速制作代码生成器

3）开发者发布代码生成器至平台

4）使用者在平台上搜索代码生成器，支持在线使用或者下载离线 jar 包（甚至还可以支持接口调用）






#### 实现思路

1）使用 Web 开发框架实现代码生成器信息的增删改查

2）将本地的配置和文件 **上云**，存储到数据库、对象存储等云服务。

3）通过可视化界面来操作第二阶段的代码生成器制作工具，复用阶段二的成果。
